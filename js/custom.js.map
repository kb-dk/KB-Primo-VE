{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/45KBDK_KGL-KGL/js/chat-box/scriptIds.constant.js","primo-explore/custom/45KBDK_KGL-KGL/js/edit-profile/kbEditProfile.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/edit-profile/prmPersonalInfoAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/footerAndHelp/kbFooter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/footerAndHelp/prmExploreFooterAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/language/kbLanguage.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/language/prmUserAreaExpandableAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/main.js","primo-explore/custom/45KBDK_KGL-KGL/js/move-request-another-bin/prmServiceButtonAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/navigation-header/kbNavigationHeader.js","primo-explore/custom/45KBDK_KGL-KGL/js/navigation-header/prmTopBarBefore.js","primo-explore/custom/45KBDK_KGL-KGL/js/open-items-location-filter/prmLocationItemsAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/js/pickup-numbers/pickUpNumbers.service.js","primo-explore/custom/45KBDK_KGL-KGL/js/pickup-numbers/prmRequestsAfter.component.js","primo-explore/custom/45KBDK_KGL-KGL/node_modules/kb-primo-ve-announcement/dist/index.js","primo-explore/custom/45KBDK_KGL-KGL/node_modules/kb-primo-ve-hide-new-user-if-loggedin/dist/index.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","scriptIds","en","da","KbEditProfileController","angular","element","document","querySelector","append","this","$element","_classCallCheck","$inject","KbEditProfileConfig","name","config","controller","templateUrl","viewName","PrmPersonalInfoAfterConfig","bindings","parentCtrl","template","KbFooterConfig","PrmExploreFooterAfterConfig","KbLanguageController","newLang","lang","$location","search","getElementsByTagName","$window","location","href","absUrl","KbLanguageConfig","PrmUserAreaExpandableAfterConfig","_prmPersonalInfoAfter","_kbEditProfile","_prmExploreFooterAfter","_kbFooter","_prmTopBarBefore","_kbNavigationHeader","_prmUserAreaExpandableAfter","_kbLanguage","_scriptIds","_prmLocationItemsAfter","_prmServiceButtonAfter","_pickUpNumbers","_prmRequestsAfter","constant","url","window","substring","query","indexOf","pathname","vid","replace","console","log","component","PrmTopBarBeforeConfig","KbNavigationHeaderConfig","PrmLocationItemsAfterConfig","PrmServiceButtonAfterConfig","service","PickUpNumbersService","PrmRequestsAfterConfig","PrmServiceButtonAfterController","_this","intervalId","$interval","AlmaRequestOther","cancel","parent","textContent","container","hasClass","tagName","addClass","css","requestButtons","querySelectorAll","addEventListener","getElementsByClassName","backButtons","_i","remove","KbNavigationHeaderController","parentElement","children","PrmLocationItemsAfterController","filterBtn1","filterBtn2","filterDiv","triggerHandler","$intervalId","activateFilter","$http","_pickUpNumbersForIds","_runningPromise","_ongoingInsertions","ctrl","$scope","$watch","selector","newVal","oldVal","retrieveAndInsertPickUpNumbers","requestsService","requestsDisplay","targetContainer","requests","_this2","then","_insert","baseUrl","$$absUrl","includes","pickUpNumber","newElement","innerHTML","getPickupLabel","_this3","addPickupnumbersToOverview","overview_requests","index","Object","keys","requestId","_this4","Promise","resolve","reject","targetElements","requestObjects","_composeRequestObjects","inserts","forEach","request","key","_insertForRequest","insertPickupnumbersToOverview","catch","map","id","expandedDisplay","isAlert","_this5","insertPickUpNumber","_retrievePickUpNumber","response","data","number","err","get","getServiceBaseUrl","PrmRequestsAfterController","pickUpNumbersService","waitForIdsAndInsertPickUpNumbers","s","l","defineProperty","value","enumerable","configurable","writable","TypeError","$translate","$mdToast","$rootScope","$cookies","_dismissed","$on","AnnouncementService","_toastPromise","hide","show","hideDelay","position","close","put","controllerAs","_dismiss","prototype","2","announcementService","display","PrmTopbarAfterConfig","primoExploreCtrl","3","./announcement/announcement.service","./announcement/prmTopbarAfter.component","isLoggedIn","ready","PrmTopNavBarLinksAfterConfig","./hide-new-user-if-loggedin/prmTopNavBarLinksAfter.component"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","export const scriptIds = {\n    'en': 'b19d8ae41c784590fd84ba51114c29d2',\n    'da': '668df01b6f2cd836279a993a8fc944ec'\n};","class KbEditProfileController {\n    constructor($element) {\n        this.$element = $element;\n    };\n\n    $postLink() {\n        // Move edit-profile button to the desired position\n        let container = angular.element(document.querySelector('md-card#personalDetails .md-toolbar-tools'));\n        container.append(this.$element);\n    };\n}\n\nKbEditProfileController.$inject = ['$element'];\nexport let KbEditProfileConfig = {\n    name: 'kbEditProfile',\n    config: {\n        controller: KbEditProfileController,\n        templateUrl: [\"viewName\", function(viewName){\n            return 'custom/' + viewName + '/html/edit-profile/edit-profile.html';\n        }],\n    }\n};","export let PrmPersonalInfoAfterConfig = {\n    name: 'prmPersonalInfoAfter',\n    config: {\n        bindings: {parentCtrl: '<'},\n        template: `<kb-edit-profile></kb-edit-profile>`,\n    }\n};","export let KbFooterConfig = {\n    name: 'kbFooter',\n    config: {\n        templateUrl: [\"viewName\", function(viewName){\n            return 'custom/' + viewName + '/html/footer/footer.html';\n        }],\n    }\n};","export let PrmExploreFooterAfterConfig = {\n    name: 'prmExploreFooterAfter',\n    config: {\n        bindings: {parentCtrl: '<'},\n        template: `<kb-footer></kb-footer>\n                   <kb-help parent-ctrl='$ctrl.parentCtrl'></kb-help>`,\n    }\n};","class KbLanguageController {\n\n    constructor($window, $location) {\n        this.$window = $window;\n        this.$location = $location;\n        this.lang = this.parentCtrl.lang;\n\n    };\n\n    changeLanguage() {\n        let newLang = this.lang === 'da'? 'en' : 'da';\n        this.$location.search('lang', newLang);\n        document.getElementsByTagName(\"html\")[0].lang = newLang;\n        this.$window.location.href = this.$location.absUrl();\n    }\n\n}\n\nKbLanguageController.$inject = ['$window', '$location'];\n\nexport let KbLanguageConfig=  {\n    name: 'kbLanguage',\n    config: {\n        bindings: {\n            parentCtrl: '<',\n        },\n        controller: KbLanguageController,\n        templateUrl: [\"viewName\", function(viewName){\n            return 'custom/' + viewName + '/html/language/language.html';\n        }],\n    }\n};","export let PrmUserAreaExpandableAfterConfig=  {\n    name: 'prmUserAreaExpandableAfter',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        template: `<kb-language parent-ctrl='$ctrl.parentCtrl'></kb-language>`,\n    }\n};","// Edit profile\nimport {PrmPersonalInfoAfterConfig} from './edit-profile/prmPersonalInfoAfter.component';\nimport {KbEditProfileConfig} from './edit-profile/kbEditProfile.component';\n\n// Footer\nimport {PrmExploreFooterAfterConfig} from './footerAndHelp/prmExploreFooterAfter.component';\nimport {KbFooterConfig} from './footerAndHelp/kbFooter.component';\n\n//import {KbHelpConfig} from './footerAndHelp/kbHelp.component';\n\n// Navigation header\nimport {PrmTopBarBeforeConfig} from './navigation-header/prmTopBarBefore';\nimport {KbNavigationHeaderConfig} from './navigation-header/kbNavigationHeader';\n\n// Language switcher\nimport {PrmUserAreaExpandableAfterConfig} from './language/prmUserAreaExpandableAfter.component';\nimport {KbLanguageConfig} from './language/kbLanguage.component';\n\n// ChatBox scriptId\nimport {scriptIds} from \"./chat-box/scriptIds.constant\";\n\n// Open items location filter\nimport {PrmLocationItemsAfterConfig} from \"./open-items-location-filter/prmLocationItemsAfter.component\";\n\n// Move request-another-volume\nimport {PrmServiceButtonAfterConfig} from \"./move-request-another-bin/prmServiceButtonAfter.component\";\n\n// Add pickup numbers\nimport {PickUpNumbersService } from \"./pickup-numbers/pickUpNumbers.service\";\nimport {PrmRequestsAfterConfig} from \"./pickup-numbers/prmRequestsAfter.component\";\n\nangular.module('viewCustom', ['angularLoad'])\n\n    .constant('viewName', (function () {\n            let url = window.location.search.substring(1);\n            let query = url.substring(url.indexOf('vid') + 4);\n            // in 'Alma Viewer page'\n            if(!url){\n                url = window.location.pathname;\n                query = url.substring(url.indexOf('/delivery/')+10);\n                query = query.substring(0, query.indexOf('/'));\n            }\n            // If there are other parameters after vid, then remove them\n            let vid = query.substring(0, query.indexOf('&')) ? query.substring(0, query.indexOf('&')) : query;\n        vid = vid.replace(\"%3A\", \"-\");\n        console.log('vid:',vid);\n        return vid.replace(\":\", \"-\");\n    })()\n    )\n\n    // ChatBox scriptId\n    .constant('scriptIds' , scriptIds)\n\n\n    // Edit profile\n    .component(PrmPersonalInfoAfterConfig.name, PrmPersonalInfoAfterConfig.config)\n    .component(KbEditProfileConfig.name, KbEditProfileConfig.config)\n\n    // Footer and help\n    .component(PrmExploreFooterAfterConfig.name, PrmExploreFooterAfterConfig.config)\n    .component(KbFooterConfig.name, KbFooterConfig.config)\n\n   // .component(KbHelpConfig.name, KbHelpConfig.config)\n\n    // Navigation header\n    .component(PrmTopBarBeforeConfig.name, PrmTopBarBeforeConfig.config)\n    .component(KbNavigationHeaderConfig.name, KbNavigationHeaderConfig.config)\n\n    // Open items location filter\n    .component(PrmLocationItemsAfterConfig.name, PrmLocationItemsAfterConfig.config)\n\n    // Move request-another-volume\n    .component(PrmServiceButtonAfterConfig.name, PrmServiceButtonAfterConfig.config)\n\n    // Language switcher\n    .component(PrmUserAreaExpandableAfterConfig.name, PrmUserAreaExpandableAfterConfig.config)\n    .component(KbLanguageConfig.name, KbLanguageConfig.config)\n\n    // Add pickup numbers\n    .service('pickUpNumbersService', PickUpNumbersService)\n    .component(PrmRequestsAfterConfig.name, PrmRequestsAfterConfig.config)\n\n// Get more info at https://github.com/Det-Kongelige-Bibliotek/KB-Primo-VE-Announcement\nrequire('kb-primo-ve-announcement');\n\n// Get more info at https://github.com/Det-Kongelige-Bibliotek/KB-Primo-VE-Hide-New-User-If-Loggedin.git\nrequire('kb-primo-ve-hide-new-user-if-loggedin');\n\n// Get more info at https://github.com/Det-Kongelige-Bibliotek/KB-Primo-VE-libChat.git\n// require('kb-primo-ve-libchat');\n","class PrmServiceButtonAfterController {\n    constructor($element, $interval) {\n        this.$element = $element;\n        this.$interval = $interval;\n    };\n    $postLink() {\n        let _this = this;\n        this.intervalId = this.$interval(function(){\n            let AlmaRequestOther = angular.element(document.querySelector(\"span[translate='AlmaRequestOther']\"));\n            if(AlmaRequestOther.length){\n                _this.$interval.cancel(_this.intervalId);\n                AlmaRequestOther = AlmaRequestOther.parent().parent();\n                if(AlmaRequestOther[0].textContent === angular.element(_this.$element.parent())[0].textContent){\n                    let container = AlmaRequestOther.parent();\n                    while ((!container.hasClass(\"section-body\"))&&(container[0].tagName !== \"BODY\")){\n                        container = container.parent();\n                    }\n                    container.append(AlmaRequestOther.parent());\n                    AlmaRequestOther.parent().addClass('orderAtTheBottom');\n                    AlmaRequestOther.parent().css('float','right');\n                    let requestButtons = angular.element(document.querySelectorAll(\"span[translate='AlmaItemRequest']\"));\n                    for (let i = 0; i < requestButtons.length; i++) {\n                        requestButtons[i].addEventListener(\"click\", function(){\n                            if(document.getElementsByClassName(\"orderAtTheBottom\") && document.getElementsByClassName(\"orderAtTheBottom\").length){\n                                console.log('hej');\n                                AlmaRequestOther.css('display', 'none');\n                            }\n\n                        });\n                    }\n                    let backButtons = angular.element(document.querySelectorAll(\"prm-opac-back-button button\"));\n                    for (let i = 0; i < backButtons.length; i++) {\n                        backButtons[i].addEventListener(\"click\", function(){\n                            if(document.getElementsByClassName(\"orderAtTheBottom\") && document.getElementsByClassName(\"orderAtTheBottom\").length){\n                                document.getElementsByClassName(\"orderAtTheBottom\")[0].remove();\n                                AlmaRequestOther.css('display', 'inline-block');\n                            }\n\n                        });\n                    }\n                }\n            }\n        }, 500, 5);\n    };\n}\n\nPrmServiceButtonAfterController.$inject = ['$element', '$interval'];\n\nexport let PrmServiceButtonAfterConfig = {\n    name: 'prmServiceButtonAfter',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        controller: PrmServiceButtonAfterController,\n    },\n}","class KbNavigationHeaderController {\n    constructor($element) {\n        this.$element = $element;\n    };\n\n    $postLink() {\n        // Find containers parent element\n        let parentElement = this.$element.parent().parent().parent().parent();\n        // Move navigation header to the top\n        let container = angular.element(parentElement.children()[0]);\n        container.append(this.$element);\n    };\n}\n\nKbNavigationHeaderController.$inject = ['$element'];\n\nexport let KbNavigationHeaderConfig = {\n    name: 'kbNavigationHeader',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        controller: KbNavigationHeaderController,\n        templateUrl: [\"viewName\", function(viewName){\n            return 'custom/' + viewName + '/html/navigation-header/navigation-header.html';\n        }],\n    },\n}","export let PrmTopBarBeforeConfig = {\n    name: 'prmTopBarBefore',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        template:`<kb-navigation-header parent-ctrl='$ctrl.parentCtrl'></kb-navigation-header>`,\n    }\n};","class PrmLocationItemsAfterController {\n    constructor($interval) {\n        this.$interval = $interval;\n    }\n\n    activateFilter(intervalId) {\n        // Two different filter buttons in different pages. Hopefully there is not more\n        let filterBtn1 = angular.element(document.querySelectorAll(\"prm-locations > div > button.md-icon-button[aria-label='Filter']\"));\n        let filterBtn2 = angular.element(document.querySelectorAll(\"prm-location-items  div  button.md-icon-button[aria-label='Filter']\"));\n        // If the filter div exists it means it is already open\n        let filterDiv = angular.element(document.querySelectorAll(\"prm-locations-filter md-input-container\"));\n\n        if ((filterBtn1.length || filterBtn2.length) && !filterDiv.length) {\n            this.$interval.cancel(intervalId);\n            if (filterBtn1.length){\n                filterBtn1.triggerHandler('click');\n            }\n            if (filterBtn2.length){\n                filterBtn2.triggerHandler('click');\n            }\n        }else{\n            if (filterDiv.length){\n                this.$interval.cancel(intervalId);\n            }\n        }\n    }\n\n    $postLink() {\n        let _this = this;\n        this.$intervalId = this.$interval(function(){\n            _this.activateFilter(_this.$intervalId);\n        }, 500, 10);\n    }\n}\n\nPrmLocationItemsAfterController.$inject = ['$interval'];\n\nexport let PrmLocationItemsAfterConfig = {\n    name: 'prmLocationItemsAfter',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        controller: PrmLocationItemsAfterController\n    }\n};","/**\n * Service to insert the pick up numbers for the requested items.\n */\nexport class PickUpNumbersService {\n    constructor($http, $location) {\n        this.$http = $http;\n        this.location = $location;\n        this._pickUpNumbersForIds = {};\n        this._runningPromise;\n        this._ongoingInsertions = 0;\n    }\n\n    /**\n     * Binds a watcher to the given controller.\n     * The watcher watches for the elements\n     * containing the request IDs, and when the\n     * elements become available, inserts the pickup\n     * numbers if they exist.*/\n\n    waitForIdsAndInsertPickUpNumbers(ctrl) {\n        ctrl.$scope.$watch(() => ctrl.selector(ctrl.parentElement).length,\n            (newVal, oldVal) => {\n                if (newVal && newVal !== oldVal) {\n                    this.retrieveAndInsertPickUpNumbers(ctrl.parentCtrl, ctrl.parentElement, ctrl.parentCtrl.requestsService.requestsDisplay, ctrl.selector);\n                }\n            }\n        );\n    }\n\n    /**\n     *  Method to retrieve and insert the pick-up numbers\n     *  into the given DOM element.\n     *  If the method is called when a previous run\n     *  has not finished, it chains the new insertion\n     *  into the promise of the previous call.\n     *  @param {Object} targetContainer - A DOM element\n     *    containing the elements the pick-up\n     *    numbers are to be inserted.\n     *  @param {Array} requests - An array of request items,\n     *    pick-up numbers of which are to be retrieved.\n     *  @param {function} selector - A selector function to return\n     *    the target DOM elements when called with a\n     *    ancestor DOM element.\n     *  @return {Promise} A Promise to be resolved\n     *    when the pick-up numbers are inserted.\n     */\n    retrieveAndInsertPickUpNumbers(parentCtrl, targetContainer, requests, selector) {\n        if (this._runningPromise) {\n\n            // If there is an ongoing insertion,\n            // perform the new insertion when the former is done.\n            return this._runningPromise.then(() => {\n                return this._insert(parentCtrl, targetContainer, requests, selector);\n            });\n        } else {\n            // Else, perform the insertion.\n            return this._insert(parentCtrl, targetContainer, requests, selector);\n        }\n    }\n\n    getPickupLabel(){\n        let lang = this.location.search().lang;\n        let pickUpLabel;\n        if (lang === 'en') {\n            pickUpLabel = 'Pickup number: ';\n        } else {\n            pickUpLabel = 'Ventehyldenummer: ';\n        }\n        return pickUpLabel;\n    }\n\n    getServiceBaseUrl(){\n        let baseUrl = this.location.$$absUrl;\n        if (baseUrl.includes('kbdk-kgl-psb.primo.exlibrisgroup')){\n            return 'https://public-stage.statsbiblioteket.dk/alma-pickupnumbers/services/public/pickupnumber/';\n        } else if (baseUrl.includes('soeg.kb.dk')){\n            return 'https://webservice.kb.dk/alma-pickupnumbers/services/public/pickupnumber/'\n        } else {\n            return 'https://developer.statsbiblioteket.dk/alma-pickupnumbers/services/public/pickupnumber/';\n        }\n    }\n\n    insertPickUpNumber(pickUpNumber, container) {\n        if (container.innerHTML.indexOf('<span class=\"pickupnumber\">') === -1) {\n            let newElement = \"<br/><span class='pickupnumber'>\" + this.getPickupLabel() + \"</span>\" + pickUpNumber + \"<br/>\";\n            angular.element(container.querySelectorAll('p.request-location')).append(newElement);\n        }\n    }\n\n    insertPickupnumbersToOverview(requests){\n        let element = document.querySelectorAll('prm-requests-overview');\n        if (element.length>0){\n            this.addPickupnumbersToOverview(element, requests);\n        }else{\n            ctrl.$scope.$watch(() => element.length,\n                (newVal, oldVal) => {\n                    if (element.length) {\n                        this.addPickupnumbersToOverview(element, requests);\n                    }\n                }\n            );\n        }\n\n    };\n\n    addPickupnumbersToOverview(element, requests){\n        let overview_requests = angular.element(document.querySelectorAll('prm-requests-overview div[class=\"md-list-item-text layout-fill\"]'));\n        for (let index = 0; index < Object.keys(overview_requests).length-1; index++) {\n            if((this._pickUpNumbersForIds[requests[index].requestId])&&(overview_requests[index].innerHTML.indexOf('<span class=\"pickupnumber\">') === -1)){\n                let newElement = '<p class=\"weak-text\"><span class=\"pickupnumber\">'+ this.getPickupLabel() +'</span><span>'+this._pickUpNumbersForIds[requests[index].requestId]+'</span></p>';\n                angular.element(overview_requests[index]).append(newElement);\n            }\n        }\n}\n\n    _insert(parentCtrl, targetContainer, requests, selector) {\n        let ctrl = this;\n        ctrl._runningPromise = new Promise((resolve, reject) => {\n            let targetElements = selector(targetContainer);\n            let requestObjects = ctrl._composeRequestObjects(targetElements, requests);\n            ctrl._ongoingInsertions = requestObjects.length;\n\n            // Making one promise per request\n            let inserts = [];\n            requestObjects.forEach((request, key) => {\n                inserts[key] = ctrl._insertForRequest(parentCtrl.requestsDisplay[key], request);\n                inserts[key]\n                // Instead of using both then and catch methods and counting down to see when all the promises settled\n                // one can use Promise.allSettled\n                // But it is not supported in ie and some other browsers yet\n                    .then(()=>{\n                    ctrl._ongoingInsertions = ctrl._ongoingInsertions - 1;\n                        if (ctrl._ongoingInsertions === 0) {\n                            this.insertPickupnumbersToOverview(requests);\n                            resolve();\n                        }\n                    })\n                    .catch(()=>{\n                        ctrl._ongoingInsertions = ctrl._ongoingInsertions - 1;\n                        if (ctrl._ongoingInsertions === 0) {\n                            this.insertPickupnumbersToOverview(requests);\n                            resolve();\n                        }\n                    })\n            });\n        });\n\n        return this._runningPromise;\n    }\n\n    // Returns an array of objects with request related data.\n    _composeRequestObjects(targetElements, requests) {\n        return requests.map((request, index) => {\n            return {\n                element: targetElements[index],\n                id: request.requestId,\n                expandedDisplay: request.expandedDisplay,\n                isAlert: request.isAlert  // isAlert is a Primo field, that most likely says if a booking is ready for pickup or not\n            }\n        });\n    };\n\n    // Inserts the pickup number for given request.\n    _insertForRequest(requestsDisplay, request) {\n        let ctrl = this;\n        return new Promise((resolve, reject) => {\n            // If there is no DOM element to be altered,\n            // do nothing.\n            if (!request.element) {\n                reject();\n                return;\n            }\n            if (ctrl._pickUpNumbersForIds[request.id]) {\n                // If the pick-up number for the request is already known, use it.\n                // ctrl._replaceIdText(request, ctrl._pickUpNumbersForIds[request.id]);\n                this.insertPickUpNumber(ctrl._pickUpNumbersForIds[request.id], request.element);\n                resolve();\n            } else if (request.isAlert) {\n                // Else, if isAlert set to true, retrieve and insert the pick-up number.\n                // The requested item can probably only have a pick up number if its isAlert is set to true.\n                    ctrl._retrievePickUpNumber(request.id)\n                        .then(response => {\n                            // Insert the pick-up number text.\n                            let pickUpNumber = response.data.number;\n                            ctrl._pickUpNumbersForIds[request.id] = pickUpNumber;\n                            this.insertPickUpNumber(pickUpNumber, request.element);\n                            resolve();\n                        })\n                        .catch(err => {\n                            // ctrl._removeIdText(request);\n                            console.log('Could not retrieve the pick up number.');\n                            reject(err);\n                            return err;\n                        });\n\n            } else {\n                resolve();\n            }\n\n        });\n\n    }\n\n    // Retrieves the pick up numbers from the associated service.\n    // Request URL may look like the following.\n    _retrievePickUpNumber(requestId) {\n        return this.$http.get(this.getServiceBaseUrl() + requestId);\n    }\n\n\n}\n\nPickUpNumbersService.$inject = ['$http', '$location'];","class PrmRequestsAfterController {\n\n    constructor($scope, $element, pickUpNumbersService) {\n        this.$scope = $scope;\n        this.$element = $element;\n        this.pickUpNumbersService = pickUpNumbersService;\n    }\n\n    $onInit() {\n        this.parentElement = this.$element.parent()[0];\n        this.pickUpNumbersService.waitForIdsAndInsertPickUpNumbers(this);\n    }\n\n    selector(element) {\n        return element.querySelectorAll('md-list-item');\n    }\n\n}\n\nPrmRequestsAfterController.$inject = ['$scope', '$element', 'pickUpNumbersService'];\n\nexport let PrmRequestsAfterConfig = {\n    name: 'prmRequestsAfter',\n    config: {\n        bindings: {\n            parentCtrl: '<'\n        },\n        controller: PrmRequestsAfterController,\n    }\n}","!function r(s,a,c){function u(e,n){if(!a[e]){if(!s[e]){var t=\"function\"==typeof require&&require;if(!n&&t)return t(e,!0);if(l)return l(e,!0);var o=new Error(\"Cannot find module '\"+e+\"'\");throw o.code=\"MODULE_NOT_FOUND\",o}var i=a[e]={exports:{}};s[e][0].call(i.exports,function(n){return u(s[e][1][n]||n)},i,i.exports,r,s,a,c)}return a[e].exports}for(var l=\"function\"==typeof require&&require,n=0;n<c.length;n++)u(c[n]);return u}({1:[function(n,e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var o=function(n,e,t){return e&&i(n.prototype,e),t&&i(n,t),n};function i(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function r(n,e,t,o){var i=this;!function(n,e){if(!(n instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,r),this.$translate=n,this.$mdToast=e,this.$rootScope=t,this.$cookies=o,this._dismissed=!1,this.$rootScope.$on(\"$translateChangeSuccess\",function(){i._dismissed=!1})}(t.AnnouncementService=(o(r,[{key:\"_dismiss\",value:function(){this._dismissed=!0,this._toastPromise=null}},{key:\"display\",value:function(o){var i=this;return new Promise(function(e,t){!0!==i._dismissed?i.$translate(\"nui.message.announcement\").then(function(n){if(i.$cookies.get(\"announcement\")!==n){if(!n||[\"announcement\",\"&nbsp;\",\"\"].includes(n))return i._toastPromise&&!i._dismissed&&i.$mdToast.hide(),void t(\"No announcement found.\");i._toastPromise=i._toastPromise||i.$mdToast.show({hideDelay:!1,position:\"top\",controller:function(){return{close:function(){i.$mdToast.hide(),i.$translate(\"nui.message.announcement\").then(function(n){return i.$cookies.put(\"announcement\",n)})}}},controllerAs:\"$ctrl\",template:'\\n<md-toast class=\"page-notification\" style=\"top: 0px; position: sticky !important;\">\\n    <div class=\"md-toast-content\" style=\"box-shadow:none; width: 100%;\">\\n        <span class=\\'md-toast-text\\' flex translate=\\'nui.message.announcement\\'>\\n  </span>\\n    </div>\\n    <a class=\"close\" ng-click=\\'$ctrl.close()\\' aria-label=\"{{\\'nui.message.dismiss\\' | translate}}\"\\n       style=\"position: absolute; right: 1.5rem; top: 1.5rem;\">\\n        <prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"close\">\\n        </prm-icon>\\n    </a>\\n</md-toast>\\n          '}),i._toastPromise.then(o).catch(o).then(function(){return i._dismiss()}),e()}else t(\"The announcement has been dismissed before.\")}):t(\"The announcement has been dismissed.\")})}}]),r)).$inject=[\"$translate\",\"$mdToast\",\"$rootScope\",\"$cookies\"]},{}],2:[function(n,e,t){\"use strict\";function o(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=(function(n,e,t){return e&&o(n.prototype,e),t&&o(n,t),n}(r,[{key:\"$onInit\",value:function(){this.announcementService.display().catch(function(n){n&&console.log(n)})}}]),r);function r(n,e,t,o){!function(n,e){if(!(n instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,r),this.announcementService=n,this.$scope=e,this.$element=t,this.$translate=o}i.$inject=[\"announcementService\",\"$scope\",\"$element\",\"$translate\"];t.PrmTopbarAfterConfig={name:\"prmTopbarAfter\",config:{controller:i,require:{primoExploreCtrl:\"^primoExplore\"}}}},{}],3:[function(n,e,t){\"use strict\";var o=n(\"./announcement/announcement.service\"),i=n(\"./announcement/prmTopbarAfter.component\");angular.module(\"viewCustom\").service(\"announcementService\",o.AnnouncementService).component(i.PrmTopbarAfterConfig.name,i.PrmTopbarAfterConfig.config)},{\"./announcement/announcement.service\":1,\"./announcement/prmTopbarAfter.component\":2}]},{},[3]);","!function i(a,u,f){function s(n,e){if(!u[n]){if(!a[n]){var r=\"function\"==typeof require&&require;if(!e&&r)return r(n,!0);if(c)return c(n,!0);var t=new Error(\"Cannot find module '\"+n+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}var o=u[n]={exports:{}};a[n][0].call(o.exports,function(e){return s(a[n][1][e]||e)},o,o.exports,i,a,u,f)}return u[n].exports}for(var c=\"function\"==typeof require&&require,e=0;e<f.length;e++)s(f[e]);return s}({1:[function(e,n,r){\"use strict\";function t(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,\"value\"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}Object.defineProperty(r,\"__esModule\",{value:!0});var o=(function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}(i,[{key:\"$postLink\",value:function(){this.isLoggedIn&&angular.element(document).ready(function(){var e=angular.element(document.querySelector('div[data-main-menu-item=\"new_user\"]'));e&&0!==e.length&&e.css(\"display\",\"none\")})}}]),i);function i(){!function(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}(this,i),this.isLoggedIn=this.parentCtrl.isLoggedIn}r.PrmTopNavBarLinksAfterConfig={name:\"prmTopNavBarLinksAfter\",config:{bindings:{parentCtrl:\"<\"},controller:o}}},{}],2:[function(e,n,r){\"use strict\";var t=e(\"./hide-new-user-if-loggedin/prmTopNavBarLinksAfter.component\");angular.module(\"viewCustom\").component(t.PrmTopNavBarLinksAfterConfig.name,t.PrmTopNavBarLinksAfterConfig.config)},{\"./hide-new-user-if-loggedin/prmTopNavBarLinksAfter.component\":1}]},{},[2]);"]}